<!DOCTYPE html>
<html>
<head>
    <title>Test Supabase Auth</title>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
</head>
<body>
    <h1>Test Supabase Authentication</h1>
    <div id="status">Loading...</div>
    
    <div id="login-form" style="display: none;">
        <h2>Login</h2>
        <input type="email" id="email" placeholder="Email" />
        <input type="password" id="password" placeholder="Password" />
        <button onclick="login()">Login</button>
    </div>
    
    <div id="user-info" style="display: none;">
        <h2>User Info</h2>
        <div id="user-details"></div>
        <button onclick="logout()">Logout</button>
    </div>

    <script>
        const supabaseUrl = 'https://uscmvlfleccbctuvhhcj.supabase.co'
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVzY212bGZsZWNjYmN0dXZoaGNqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzQ2NzY5MDYsImV4cCI6MjA1MDI1MjkwNn0.Ll2qVfVqVqVqVqVqVqVqVqVqVqVqVqVqVqVqVqVqVqV'
        
        const supabase = window.supabase.createClient(supabaseUrl, supabaseKey)
        
        async function checkAuth() {
            const { data: { user } } = await supabase.auth.getUser()
            
            if (user) {
                document.getElementById('status').innerHTML = 'Logged in as: ' + user.email
                document.getElementById('login-form').style.display = 'none'
                document.getElementById('user-info').style.display = 'block'
                document.getElementById('user-details').innerHTML = JSON.stringify(user, null, 2)
            } else {
                document.getElementById('status').innerHTML = 'Not logged in'
                document.getElementById('login-form').style.display = 'block'
                document.getElementById('user-info').style.display = 'none'
            }
        }
        
        async function login() {
            const email = document.getElementById('email').value
            const password = document.getElementById('password').value
            
            const { data, error } = await supabase.auth.signInWithPassword({
                email: email,
                password: password
            })
            
            if (error) {
                alert('Login error: ' + error.message)
            } else {
                alert('Login successful!')
                checkAuth()
            }
        }
        
        async function logout() {
            await supabase.auth.signOut()
            checkAuth()
        }
        
        // Check auth status on load
        checkAuth()
        
        // Listen for auth changes
        supabase.auth.onAuthStateChange((event, session) => {
            console.log('Auth state changed:', event, session)
            checkAuth()
        })
    </script>
</body>
</html>
